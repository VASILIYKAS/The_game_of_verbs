# Чат-боты с интеграцией Dialogflow (VK и Telegram)

Проект включает двух чат-ботов (для ВКонтакте и Telegram), которые используют Dialogflow для обработки естественного языка. Боты могут отвечать на приветствия и другие фразы, настроенные в Dialogflow. Также реализовано логирование ошибок и отправка уведомлений администратору в Telegram.

![Гифка](https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExcnpmbzM1OG42cjJhNjN0YXUyMGs2aWUzcmFzeXVvdjZ3OHVzZzJnZiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/PNXw5ourrV5MAyZMrI/giphy.gif)

## Оглавление

- [Установка и запуск](#установка-и-запуск)
    - [Переменные окружения](#переменные-окружения)
- [Обучение Dialogflow](#обучение-dialogflow)
- [Запуск ботов](#запуск-ботов)
- [Цель проекта](#цель-проекта)

## Установка и запуск

- Python 3.13 должен быть установлен
- Скачайте код:
```bash
git clone https://github.com/VASILIYKAS/The_game_of_verbs.git
```
- Рекомендуется создать виртуальное окружение. Для этого нужно выполнить команду: 
```bash
python -m venv .venv
```
- Так же при необходимости вы можете активировать виртуальное окружение:
```bash
.venv\Scripts\activate
```
- Затем нужно установить все необходимые библиотеки, сделать это можно командой: 
```bash
pip install -r requirements.txt
```

- Скрипт запускается из командной строки или терминала IDE. 
- Перед запуском убедитесь что вы находитесь в папке с файлом.
- Для перехода между папками используйте команду `cd`. 
- Для перехода между дисками необходимо указать имя диска.

## Переменные окружения

Создайте файл .env в корне проекта со следующими переменными:
```ini
TG_BOT_TOKEN=ваш_токен_телеграм_бота
VK_TOKEN=ваш_токен_vk
GOOGLE_APPLICATION_CREDENTIALS=dialogflow-key.json
PROJECT_ID=id_вашего_проекта
SEND_LOG_BOT_TOKEN=токен_бота_для_логов
chat_id=ваш_chat_id
LOGS_DIR=ваша_папка_для_логов
LOG_FILE=ваш_файл_для_логов.log
```

- `TG_BOT_TOKEN` - можно получить у отца ботов в телеграм [ссылка](https://t.me/BotFather)

- `VK_TOKEN` - для получения VK токена нужно создать [сообщество](https://vk.com/groups) в ВК (если оно не создано), зайти в "Управление" -> "Дополнительно" -> "Работа с API" -> "Создать ключ"

- `GOOGLE_APPLICATION_CREDENTIALS` - указать как в примере. Для получения файла "dialogflow-key.json" Нужно: 
    - создать проект в [Google Cloud Console](https://console.cloud.google.com/).
    - Перейдите в "APIs & Services" -> "Library".
    - Найдите "Dialogflow API" и нажмите "Enable".
    - Перейдите в "IAM & Admin" -> "Service Accounts".
    - Нажмите "+ Create Service Account". 
        - Укажите любое имя.
        - Задайте роль "Dialogflow API Admin".
    - Нажмите на созданный аккаунт и откройти вкладку "Keys".
    - Нажмите "Add key" -> "Create new key" -> "JSON" - > "create" файл скачается автоматически.
    - Переименуйте его в "dialogflow-key.json" и переместите в корень проекта.

- `PROJECT_ID` - Можно найти на [главной странице](https://console.cloud.google.com/) (Dashboard)
- `SEND_LOG_BOT_TOKEN` - Ещё один токен бота который будет отправлять вам сообщения в телеграмм, об ошибках связанных с работой ботов, получить так же у [отца ботов](https://t.me/BotFather). 

- `chat_id` - ID вашего телеграмм чата узнать можно у [бота](https://t.me/userinfobot), просто отправьте ему любое сообщение.

- `LOGS_DIR` - Укажите название папки куда будут сохраняться логи. По умолчанию создаётся папка "logs"
- `LOG_FILE` - Укажите название файла для сохранения логов. По умолчанию создаётся файл "bot.log" 

## Обучение Dialogflow

Для добавления новых фраз для обработки:
- Отредактируйте файл questions.json, добавив новые интенты в формате:
```json
{
  "имя_интента": {
    "questions": ["фраза 1", "фраза 2"],
    "answer": "ответ бота"
  }
}
```
Запустите скрипт обучения:
```bash
python learning_script.py
```

## Запуск ботов

Запустите каждый бот в отдельном терминале:
Для Telegram:
```bash
python tg_bot.py
```

Для ВКонтакте:
```bash
python vk_bot.py
```
Все ошибки логируются в файлы и отправляются администратору в Telegram через указанный бот для логов.

## Цель проекта

Код написан в учебных целях — это урок в курсе по Python и веб-разработке на сайте [Devman](https://dvmn.org).
    